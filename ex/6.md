# :camera: Im√°genes

Aplicaciones como videojuegos o experiencias 3D de calidad, generalmente precargan sus assets como modelos o texturas antes de hacer el render de las escenas. De esta manera, se asegura que los assets son visibles cuando se requieran, mejorando as√≠ el rendimiento y la experiencia de usuario al no descargarlos durante el proceso de render.

Por esta raz√≥n, A-Frame tiene un sistema de manejo de assets que nos permite ubicarlos en un solo lugar, para precargarlos y almacenarlos en el cache de la aplicaci√≥n para mejorar el rendimiento.

## Asset Management System
El [sistema de manejo de assets](https://aframe.io/docs/0.8.0/core/asset-management-system.html) de A-frame, nos permite ubicar todos estos archivos dentro de la etiqueta `<a-assets>` que a su vez debe ir dentro de nuestra `<a-scene>`.

Los assets pueden ser:

* **<a-asset-item> -** Assets varios como modelos 3D y materiales.
* **<audio> -** Archivos de audio.
* **<img> -** Archivos de imagen.
* **<video> -** Archivos de video.

Para utilizar estos archivos, debemos definirlos en `<a-assets>` y apuntar a ellos usando selectores. Por ejemplo:

```html
<a-scene>
  <!-- Asset management system. -->
  <a-assets>
    <a-asset-item id="horse-obj" src="horse.obj"></a-asset-item>
    <a-asset-item id="horse-mtl" src="horse.mtl"></a-asset-item>
    <a-mixin id="giant" scale="5 5 5"></a-mixin>
    <audio id="neigh" src="neigh.mp3"></audio>
    <img id="advertisement" src="ad.png">
    <video id="kentucky-derby" src="derby.mp4"></video>
  </a-assets>

  <!-- Scene. -->
  <a-plane src="#advertisement"></a-plane>
  <a-sound src="#neigh"></a-sound>
  <a-entity geometry="primitive: plane" material="src: #kentucky-derby"></a-entity>
  <a-entity mixin="giant" obj-model="obj: #horse-obj; mtl: #horse-mtl"></a-entity>
</a-scene>
````

La escena no ser√° renderizada o inicializada hasta que el navegador haya descargado todos los assets o hasta que el sistema de archivos alcance un tiempo l√≠mite.

### CORS: Cross-Origin Resource Sharing
Debido a que A-Frame carga los assets usando[XHRs](#point_right-aclaraciones), se requiere por motivos de seguridad que el navegador sirva los archivos con [headers CORS](#point_right-aclaraciones) si el asset est√° en un dominio diferente, de lo contrario tendr√≠amos que almacenar dichos assets en el mismo origen que la escena.

Una opci√≥n, es usar [GitHub Pages](https://pages.github.com/) como plataforma para desplegar nuestras escenas, ya que todos los archivos los sirven con headers CORS.

Tambi√©n podemos utilizar el [A-Frame Asset Uploader](https://cdn.aframe.io/), que nos permite servir archivos est√°ticos con los respectivos headers. De esta manera, `<a-assets>` ajustar√° los atributos `crossorigin` en los assets si detecta que est√°n en un dominio diferente.

## Im√°genes en A-Frame
Existen b√°sicamente tres formas de utilizar im√°genes en A-Frame:

* Im√°genes equirectangulares o 360
* Texturas
* Im√°genes posicionales

### Im√°genes equirectangulares
Una imagen equirecatngular o panor√°mica, es aquella que al ser proyectada de forma esf√©rica nos rodea 360¬∞ a lo largo del horizonte, 90¬∞ hacia arriba y 90¬∞ hacia abajo. Estas im√°genes tienen una proporci√≥n ancho:alto de 2:1.

En A-Frame, contamos con la primitiva `<a-sky>` que nos permite agregar un color de fondo como ya vimos anteriormente, o una imagen 360 a nuestra escena, como veremos a cotninuaci√≥n. B√°sicamente, un [sky](https://aframe.io/docs/0.8.0/primitives/a-sky.html#example) es una gran esfera con un color o una textura mapeada hacia adentro.

En este punto ya es conveniente empezar a desarrollar nuestras escenas de manera local en un editor de texto como [Atom](https://atom.io/), [Sublime Text](https://www.sublimetext.com/) o [VS Code](https://code.visualstudio.com/).

Pare el primer primer ejemplo utilizaremos el [A-Frame Asset Uploader](https://cdn.aframe.io/) para cargar una imagen en nuestra escena. Lo √∫nico que debemos hacer es subir una imagen y obtendremos un enlace que sirve nuestro archivo con los headers adecuados.

Podemos encontrar una imagen para este ejercicio en el grupo de flickr [equirecatngular](https://www.flickr.com/groups/equirectangular/). All√≠, miles de personas alrededor del mundo comparten sus fotograf√≠as 360, solo debemos buscar una que tenga licencia Creative Commons y la descargamos.

Una vez tenemos lista la imagen, debemos cargarla en el Asset Uploader y all√≠ obtendremos el link a la imagen.

Ahora bien, en nuestro editor de texto favorito, debemos crear un archivo HTML tradicional. All√≠, en la parte superior del Body, debemos agregar el script de A-Aframe y posteriormente nuestra `<a-scene>`

```html
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta charset="utf-8">
  <title>VR Images</title>
</head>
  <body>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <a-scene>
      <!-- here goes the  VR scene -->
    </a-scene>
  </body>
</html>
````

Ahora debemos agregar el asset que queremos cargar en nuestra escena. Para ello, debemos agregar el tag `<a-assets>` y dentro de √©l, debemos incluir la etiqueta `<img>` con los respectivos atributos. En `id` escribiremos el selector con el cual apuntaremos a la imagen, y en `src` el link que obtuvimos del Asset Uploader.

```html
...

<a-scene>
  <a-assets>
    <img id="river" src="https://ucarecdn.com/581620e6-68fb-4e6c-8c4e-7120117b8411/">
  </a-assets>
  <a-sky src="#river"></a-sky>
</a-scene>

...
````

Si al abrir el archivo .html en el navegador, no puedes ver la imagen sino que ves todo el fondo negro, es probable que el error sea al servir el archivo por CORS.

### Texturas

### Im√°genes posicionales
___
### :point_right: Aclaraciones
>XHRs:
>CORS:

### üìù [Soluci√≥n]()

[‚è™](https://github.com/fcor/aframe-workshop/blob/master/ex/5.md)  [‚è©](https://github.com/fcor/aframe-workshop/blob/master/ex/7.md)
